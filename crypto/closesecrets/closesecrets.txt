I tried to make my Diffie-Hellman implementation a bit more interesting, but maybe I went too far?

Can you make sense of this custom cryptography and decode the encrypted flag?
